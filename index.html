<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Comf-IA: Taller Gemini + Apps Script</title>
    <!-- Cargar Tailwind CSS --><script src="https://cdn.tailwindcss.com"></script>
    <!-- Cargar Fuente "Inter" --><link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    <!-- Cargar Fuente "Caveat" para la firma --><link href="https://fonts.googleapis.com/css2?family=Caveat:wght@700&display=swap" rel="stylesheet">
    
    <style>
        /* Tipografía Base */
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: #030712; /* gray-950 */
            color: #D1D5DB; /* gray-300 */
        }

        /* Gradiente de texto "World-Class" */
        .text-gradient {
            background: linear-gradient(to right, #C084FC, #EC4899); /* purple-400 to pink-500 */
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        /* Estilos de Slide y Transiciones */
        #slide-container {
            position: relative;
            width: 100%;
            height: 100%;
        }
        
        .slide {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 1.5rem; /* p-6 */
            opacity: 0;
            transform: translateY(15px);
            transition: opacity 0.4s ease-out, transform 0.4s ease-out;
            z-index: 1;
            pointer-events: none; /* No se puede interactuar si no está activo */
        }
        
        .slide-active {
            opacity: 1;
            transform: translateY(0);
            z-index: 10;
            pointer-events: auto; /* Se puede interactuar */
        }

        /* Barra de progreso */
        #progress-bar-inner {
            transition: width 0.3s ease-out;
            background-color: #A855F7; /* purple-500 */
        }
        
        /* Estilo para los bloques de código */
        pre {
            background-color: #111827; /* gray-900 */
            color: #E5E7EB; /* gray-200 */
            padding: 1.5rem;
            border-radius: 0.75rem; /* rounded-xl */
            overflow-x: auto;
            border: 1px solid #1F2937; /* gray-800 */
            box-shadow: 0 4px 6px rgba(0,0,0,0.2);
        }
        code {
            font-family: 'Courier New', Courier, monospace;
            font-size: 0.95em;
            line-height: 1.6;
        }
        /* Colores de sintaxis del prompt */
        .code-title-role { color: #A78BFA; /* violet-400 */ }
        .code-title-context { color: #F0ABFC; /* fuchsia-300 */ }
        .code-title-req { color: #FCD34D; /* amber-300 */ }
        .code-title-output { color: #A3E635; /* lime-400 */ }

        /* Estilo para la firma */
        .signature {
            font-family: 'Caveat', cursive;
            font-weight: 700;
            font-size: 2.5rem; /* text-4xl - un poco más grande */
            color: #D1D5DB; /* gray-300 */
            letter-spacing: 0.5px; /* Simula la letra "pegada" */
            transform: rotate(-3deg); /* Ligera inclinación de bolígrafo */
            display: inline-block;
            margin-top: 0.5rem; /* Espacio arriba */
        }

    </style>
</head>
<body class="antialiased overflow-hidden h-screen flex flex-col">

    <!-- Encabezado Fijo (Efecto "Vidrio" sutil) --><header class="bg-gray-950/70 backdrop-blur-md shadow-lg w-full fixed top-0 left-0 z-50 border-b border-gray-800/70">
        <nav class="container mx-auto max-w-7xl px-6 py-3 flex justify-between items-center">
            <div class="text-2xl font-extrabold text-white">
                Comf<span class="text-gradient">IA</span>
            </div>
            <div class="hidden md:flex space-x-6">
                <!-- LINKS ACTUALIZADOS --><a href="#" class="text-gray-400 hover:text-purple-400 transition-colors" data-slide="0">Intro</a>
                <a href="#" class="text-gray-400 hover:text-purple-400 transition-colors" data-slide="3">Componentes</a>
                <a href="#" class="text-gray-400 hover:text-purple-400 transition-colors" data-slide="6">Demo</a>
                <a href="#" class="text-gray-400 hover:text-purple-400 transition-colors" data-slide="14">Conclusión</a>
            </div>
            <!-- Botón de Pantalla Completa --><button id="fullscreen-btn" title="Maximizar Presentación" class="text-gray-400 hover:text-purple-400 transition-colors ml-6">
                <!-- Icono de Expandir (Default) --><svg id="expand-icon" class="w-6 h-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 3.75v4.5m0-4.5h4.5m-4.5 0L9 9M3.75 20.25v-4.5m0 4.5h4.5m-4.5 0L9 15M20.25 3.75v4.5m0-4.5h-4.5m4.5 0L15 9m5.25 15.75v-4.5m0 4.5h-4.5m4.5 0L15 15" />
                </svg>
                <!-- Icono de Minimizar (Oculto) --><svg id="minimize-icon" class="w-6 h-6 hidden" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M9 9L3.75 3.75M9 9h4.5m-4.5 0v4.5m0-4.5L3.75 15M15 9l5.25-5.25M15 9h-4.5m4.5 0v4.5m0-4.5L20.25 15M9 15l-5.25 5.25M9 15h4.5m-4.5 0v-4.5m0 4.5L3.75 9m6 6l5.25 5.25M15 15h-4.5m4.5 0v-4.5m0 4.5L20.25 9" />
                </svg>
            </button>
        </nav>
        <!-- Barra de Progreso --><div id="progress-bar-container" class="w-full bg-gray-800 h-1">
            <div id="progress-bar-inner" class="h-1 shadow-lg shadow-purple-500/30" style="width: 0%;"></div>
        </div>
    </header>

    <!-- Contenedor Principal de Slides --><main class="flex-grow w-full pt-16 pb-16 overflow-hidden"> <!-- Padding para header y footer --><div id="slide-container"> <!-- Contenedor relativo para slides absolutos --><!-- Slide 0: Bienvenida --><section class="slide slide-active" data-title="Intro">
                <div class="w-full max-w-4xl p-10 text-center">
                    <h2 class="text-xl font-semibold text-purple-400 mb-2">TALLER COMF-IA</h2>
                    <h1 class="text-5xl md:text-7xl font-extrabold text-white mb-6">Crea una App Web en 10 Min:</h1>
                    <h2 class="text-5xl md:text-7xl font-extrabold text-gradient mb-8">Gemini + Apps Script</h2>
                    <p class="text-xl text-gray-400 mb-4 max-w-2xl mx-auto">Aprende a conectar la IA con tus hojas de cálculo para crear herramientas reales.</p>
                    <div class="mt-10">
                        <p class="signature">Wilson Pareja Castaño</p>
                        <p class="text-sm text-gray-500">Vector Organización y Cultura TED</p>
                    </div>
                </div>
            </section>

            <!-- SLIDE DE VIDEO ELIMINADO --><!-- Slide 1: El Objetivo (antes 2) --><section class="slide" data-title="Intro">
                <div class="w-full max-w-5xl p-10">
                    <h2 class="text-4xl font-bold text-gradient mb-8 text-center">Nuestro Objetivo de Hoy</h2>
                    <div class="flex flex-col md:flex-row items-center bg-gray-900/50 p-8 rounded-2xl border border-gray-800">
                        <div class="md:w-1/2 p-4">
                            <img src="https://www.disruptiva.media/wp-content/uploads/elementor/thumbs/Portada-RED-Disruptiva-qdhe4kuxe9a5ckkmuu1e618a36ey4dewzdr0ble6bs.png" alt="Esquema de la App" class="rounded-lg shadow-2xl w-full border border-gray-700 object-cover" style="height: 350px;">
                        </div>
                        <div class="md:w-1/2 p-4 text-gray-300 space-y-4">
                            <p class="text-lg">Vamos a construir una <strong class="text-purple-300">aplicación web funcional</strong> desde cero.</p>
                            <ul class="list-disc list-inside space-y-2 text-lg">
                                <li>Un formulario de "Encuesta de Satisfacción".</li>
                                <li>Que guarde las respuestas <strong class="text-purple-300">automáticamente</strong> en una Google Sheet.</li>
                                <li>Usando a <strong class="text-purple-300">Gemini</strong> para generar *casi todo* el código.</li>
                            </ul>
                            <p class="text-lg font-semibold text-center mt-4 text-white">¡Sin ser expertos programadores!</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Slide 2: La Agenda (antes 3) --><section class="slide" data-title="Intro">
                <div class="w-full max-w-4xl p-10">
                    <h2 class="text-4xl font-bold text-gradient mb-10 text-center">Agenda del Taller (1 Hora)</h2>
                    <ol class="list-decimal list-inside space-y-5 text-xl text-gray-300">
                        <li class="mb-2"><strong class="text-white">¿Qué vamos a construir?</strong> (5 min)</li>
                        <li class="mb-2"><strong class="text-white">Los 3 Componentes Clave</strong>: Sheets, Apps Script y Gemini. (10 min)</li>
                        <li class="mb-2"><strong class="text-white">¡Manos a la Obra! (Live Demo)</strong> (30 min)
                            <ul class="list-disc list-inside ml-8 text-lg mt-3 space-y-2 text-gray-400">
                                <li>Configurar la Hoja de Cálculo.</li>
                                <li>El "Prompt Mágico" en Gemini.</li>
                                <li>Copiar, Pegar y Desplegar.</li>
                                <li>¡Depurar el error más común!</li>
                            </ul>
                        </li>
                        <li class="mb-2"><strong class="text-white">Conclusiones y Próximos Pasos</strong> (10 min)</li>
                        <li class="mb-2"><strong class="text-white">Preguntas y Certificado</strong> (5 min)</li>
                    </ol>
                </div>
            </section>
            
            <!-- Slide 3: Componente 1 - Google Sheets (antes 4) --><section class="slide" data-title="Componentes">
                <div class="w-full max-w-5xl p-10">
                     <h2 class="text-4xl font-bold text-gradient mb-8 text-center">Componente 1: Google Sheets</h2>
                     <div class="flex flex-col md:flex-row items-center">
                         <div class="md:w-1/2 p-4">
                             <img src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=1700/uploads/users/151/posts/30970/image/what-is-google-sheets.jpg" alt="Google Sheets" class="rounded-lg shadow-2xl w-full border-4 border-green-500/50 object-cover" style="height: 350px;">
                         </div>
                         <div class="md:w-1/2 p-4 text-gray-300 space-y-4">
                             <p class="text-2xl font-semibold text-white">"Nuestra Base de Datos"</p>
                             <p class="text-lg">Es el lugar donde <strong class="text-green-400">vivirán</strong> todos los datos que recolectemos.</p>
                             <p class="text-lg">No es solo una hoja de cálculo; es el <strong class="text-green-400">almacén</strong> de nuestra aplicación.</p>
                             <p class="text-lg"><strong class="text-white">Rol en el proyecto:</strong> Ser el destino final de las respuestas de la encuesta.</p>
                         </div>
                     </div>
                </div>
            </section>

            <!-- Slide 4: Componente 2 - Apps Script (antes 5) --><section class="slide" data-title="Componentes">
                <div class="w-full max-w-5xl p-10">
                     <h2 class="text-4xl font-bold text-gradient mb-8 text-center">Componente 2: Apps Script</h2>
                     <div class="flex flex-col md:flex-row items-center">
                         <div class="md:w-1/2 p-4">
                             <img src="https://i.imgur.com/L8zaVm5.png" alt="Apps Script" class="rounded-lg shadow-2xl w-full border-4 border-pink-500/50 object-cover" style="height: 350px;">
                         </div>
                         <div class="md:w-1/2 p-4 text-gray-300 space-y-4">
                             <p class="text-2xl font-semibold text-white">"El Cerebro y los Cables"</p>
                             <p class="text-lg">Es el "pegamento" mágico (y secreto) de Google. Permite que todas las apps de Google <strong class="text-pink-400">hablen entre sí</strong>.</p>
                             <p class="text-lg">Está <strong class="text-pink-400">dentro</strong> de tu Google Sheet (en Extensiones > Apps Script).</p>
                             <p class="text-lg"><strong class="text-white">Rol en el proyecto:</strong>
                                <ul class="list-disc list-inside ml-4 text-gray-300">
                                    <li>Crear la URL de la página web.</li>
                                    <li>Recibir los datos del formulario.</li>
                                    <li>Escribir esos datos en la hoja.</li>
                                </ul>
                             </p>
                         </div>
                     </div>
                </div>
            </section>

            <!-- Slide 5: Componente 3 - Gemini (antes 6) --><section class="slide" data-title="Componentes">
                <div class="w-full max-w-5xl p-10">
                     <h2 class="text-4xl font-bold text-gradient mb-8 text-center">Componente 3: Gemini (IA)</h2>
                     <div class="flex flex-col md:flex-row items-center">
                         <div class="md:w-1/2 p-4">
                             <!-- ##### IMAGEN ACTUALIZADA AQUÍ ##### --><img src="https://i.imgur.com/q87SxFH.png" alt="Gemini AI" class="rounded-lg shadow-2xl w-full border-4 border-purple-500/50 object-cover" style="height: 350px;">
                         </div>
                         <div class="md:w-1/2 p-4 text-gray-300 space-y-4">
                             <p class="text-2xl font-semibold text-white">"El Programador Experto"</p>
                             <p class="text-lg">Es nuestro asistente de IA que <strong class="text-purple-400">escribirá el código</strong> por nosotros.</p>
                             <p class="text-lg">No necesitamos saber programar, solo saber <strong class="text-purple-400">pedirle</strong> las cosas de forma clara.</p>
                             <p class="text-lg"><strong class="text-white">Rol en el proyecto:</strong> Generar los dos archivos de código (`Code.gs` y `Index.html`) que necesita Apps Script.</p>
                         </div>
                     </div>
                </div>
            </section>

            <!-- Slide 6: Demo - Paso 1 (antes 7) --><section class="slide" data-title="Demo">
                <div class="w-full max-w-5xl p-10">
                    <h2 class="text-4xl font-bold text-gradient mb-8 text-center">Demo: Paso 1 - Preparar la Base</h2>
                    <div class="flex flex-col md:flex-row items-center bg-gray-900/50 p-8 rounded-2xl border border-gray-800">
                        <div class="md:w-1/2 p-4">
                            <img src="https://placehold.co/600x400/10B981/030712?text=1.+Crear+Sheet+%26%0A2.+Abrir+Apps+Script" alt="Pasos 1 y 2" class="rounded-lg shadow-md w-full h-auto border border-gray-700">
                        </div>
                        <div class="md:w-1/2 p-4 text-gray-300">
                            <ol class="list-decimal list-inside space-y-6 text-xl">
                                <li>
                                    <strong class="text-white">Crear una Google Sheet nueva.</strong>
                                    <p class="text-lg ml-4 text-gray-400">Dale el nombre que quieras. Ej: "Resultados Encuesta".</p>
                                </li>
                                <li>
                                    <strong class="text-white">Crear la hoja "Respuestas".</strong>
                                    <p class="text-lg ml-4 text-gray-400">Abajo, en las pestañas, renombra "Hoja 1" a <strong class="text-red-400">Respuestas</strong>. (¡Esto es vital!)</p>
                                </li>
                                <li>
                                    <strong class="text-white">Abrir Apps Script.</strong>
                                    <p class="text-lg ml-4 text-gray-400">Ve a <code class="bg-gray-800 px-2 py-1 rounded text-pink-400">Extensiones > Apps Script</code>.</p>
                                </li>
                            </ol>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Slide 7: Demo - Paso 2 (antes 8) --><section class="slide" data-title="Demo">
                <div class="w-full max-w-4xl p-10 text-center">
                    <h2 class="text-4xl font-bold text-gradient mb-8">Demo: Paso 2 - El "Prompt Mágico"</h2>
                    <p class="text-xl text-gray-400 mb-8 max-w-2xl mx-auto">Ahora, vamos a Gemini y le pedimos el código usando una estructura clara y profesional.</p>
                    <div class="w-full max-w-3xl mx-auto">
                        <img src="https://placehold.co/600x300/8B5CF6/030712?text=Ir+a+Gemini..." alt="Gemini" class="rounded-lg shadow-2xl w-full h-auto border border-gray-700">
                    </div>
                </div>
            </section>

            <!-- Slide 8: Demo - El Prompt (antes 9) --><section class="slide" data-title="Demo">
                <div class="w-full max-w-6xl p-4 md:p-10 overflow-y-auto" style="max-height: 90vh;">
                    <h2 class="text-4xl font-bold text-gradient mb-6 text-center">Demo: El "Prompt Mágico" para Gemini</h2>
                    <p class="text-center text-lg text-gray-400 mb-6">Lo más importante es pedir las cosas con claridad, en lenguaje natural.</p>
                    <pre>
<code><span class="code-title-role">ROL:</span> Actúa como un programador experto en Google Apps Script que
crea aplicaciones web.

<span class="code-title-context">CONTEXTO:</span>
Quiero crear una encuesta de satisfacción para clientes (Cx)
Necesito un formulario web que guarde las respuestas en mi Google Sheet.

<span class="code-title-req">REQUERIMIENTO</span>
Dame el código para dos archivos:

<span class="code-title-output">Archivo 1: Code.gs</span>
1.  Necesito una función para mostrar la página web (`Index.html`).
2.  Guardar las respuestas en Google Sheet hoja: “Respuestas”.
3.  Si la pestaña `Respuestas` está vacía, debe escribir los títulos:
4.  Incluye la fecha de la respuesta
5.  Debe avisarme si todo se guardó correctamente.

<span class="code-title-output">Archivo 2: Index.html (El formulario web)</span>
1.  Quiero un formulario web moderno y disruptivo de impacto visual
2.  El formulario debe medir la experiencia del cliente 
3.  Cuando el usuario presione "Enviar", debe mandar "guardar" los datos
4.  Si todo sale bien, debe ocultar el formulario y mostrar un mensaje de agradecimiento.
5.  Si algo falla, debe mostrar un mensaje de error.
</code>
</pre>
                </div>
            </section>

            <!-- Slide 9: Demo - Paso 3 (antes 10) --><section class="slide" data-title="Demo">
                <div class="w-full max-w-5xl p-10">
                    <h2 class="text-4xl font-bold text-gradient mb-8 text-center">Demo: Paso 3 - Copiar y Pegar</h2>
                    <div class="flex flex-col md:flex-row items-center bg-gray-900/50 p-8 rounded-2xl border border-gray-800">
                        <div class="md:w-1/2 p-4">
                            <img src="https://placehold.co/600x400/EC4899/030712?text=1.+Pegar+Code.gs%0A2.+Crear+Index.html%0A3.+Pegar+HTML" alt="Copiar y Pegar" class="rounded-lg shadow-md w-full h-auto border border-gray-700">
                        </div>
                        <div class="md:w-1/2 p-4 text-gray-300">
                            <ol class="list-decimal list-inside space-y-6 text-xl">
                                <li>
                                    <strong class="text-white">Pegar en `Code.gs`</strong>
                                    <p class="text-lg ml-4 text-gray-400">Borra todo el código que había y pega el código `Code.gs` de Gemini.</p>
                                </li>
                                <li>
                                    <strong class="text-white">Crear `Index.html`</strong>
                                    <p class="text-lg ml-4 text-gray-400">En el editor de Apps Script, haz clic en "+" > "HTML". Nombra el archivo <strong class="text-red-400">Index</strong> (¡Mayúscula inicial!).</p>
                                </li>
                                <li>
                                    <strong class="text-white">Pegar en `Index.html`</strong>
                                    <p class="text-lg ml-4 text-gray-400">Borra todo y pega el código `Index.html` de Gemini.</p>
                                </li>
                                <li>
                                    <strong class="text-white">Guardar el proyecto.</strong>
                                </li>
                            </ol>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Slide 10: Demo - Paso 4 (antes 11) --><section class="slide" data-title="Demo">
                <div class="w-full max-w-5xl p-10">
                    <h2 class="text-4xl font-bold text-gradient mb-8 text-center">Demo: Paso 4 - Desplegar</h2>
                    <div class="flex flex-col md:flex-row items-center bg-gray-900/50 p-8 rounded-2xl border border-gray-800">
                        <div class="md:w-1/2 p-4">
                            <img src="https://placehold.co/600x400/8B5CF6/030712?text=Deploy+(Botón+Azul)" alt="Desplegar" class="rounded-lg shadow-md w-full h-auto border border-gray-700">
                        </div>
                        <div class="md:w-1/2 p-4 text-gray-300">
                            <ol class="list-decimal list-inside space-y-6 text-xl">
                                <li>
                                    <strong class="text-white">Nueva Implementación</strong>
                                    <p class="text-lg ml-4 text-gray-400">Clic en "Implementar" > "Nueva implementación".</p>
                                </li>
                                <li>
                                    <strong class="text-white">Configurar Acceso</strong>
                                    <p class="text-lg ml-4 text-gray-400">Selecciona tipo "Aplicación web". En "Quién tiene acceso", elige <strong class="text-red-400">"Cualquier usuario"</strong>.</p>
                                </li>
                                <li>
                                    <strong class="text-white">Autorizar Permisos</strong>
                                    <p class="text-lg ml-4 text-gray-400">Haz clic en "Implementar". Te pedirá permisos para acceder a tu Google Sheet.</p>
                                </li>
                                <li>
                                    <strong class="text-white">¡Copiar la URL y probar!</strong>
                                </li>
                            </ol>
                            <div class="mt-6 p-4 bg-yellow-900/30 border border-yellow-700 text-yellow-300 rounded-lg">
                                <strong class="font-bold">Nota del Experto:</strong> Si al abrir la URL ves un error de `doGet`, es porque olvidaste pedirle a Gemini esa función. (Nuestro prompt ya la incluye).
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Slide 11: Demo - ¡Posible Error y Solución! (antes 12) --><section class="slide" data-title="Demo">
                <div class="w-full max-w-6xl p-4 md:p-10 overflow-y-auto" style="max-height: 90vh;">
                    <h2 class="text-4xl font-bold text-gradient mb-6 text-center">¡Posible Error y Solución! (Depuración)</h2>
                    <p class="text-center text-lg text-gray-400 mb-6">¿Qué pasa si el formulario <strong class="text-red-400">no guarda</strong> y ves un error `e.parameter` en la consola?</p>
                    <p class="text-center text-lg text-gray-400 mb-6">Significa que el HTML envía `datos` simples, pero `Code.gs` espera `e.parameter`. ¡Es el error más común!</p>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-8">
                        <div>
                            <h3 class="text-xl font-bold text-red-400 mb-3 text-center">ANTES (Incorrecto)</h3>
                            <pre class="border-2 border-red-600 shadow-lg shadow-red-500/10">
<code class="language-javascript">// En Code.gs
// Gemini a veces genera esto por error
function guardarDatos(e) {
  
  // ... código ...

  const nuevaFila = [
    new Date(),
    e.parameter.nombre, // <-- ¡ERROR!
    e.parameter.email,  // <-- ¡ERROR!
    // ... etc
  ];

  // ... código ...
}</code>
</pre>
                        </div>
                        <div>
                            <h3 class="text-xl font-bold text-green-400 mb-3 text-center">DESPUÉS (Correcto)</h3>
                            <pre class="border-2 border-green-600 shadow-lg shadow-green-500/10">
<code class="language-javascript">// En Code.gs
// La forma correcta (como se lo pedimos)
function guardarDatos(datos) {

  // ... código ...

  const nuevaFila = [
    new Date(),
    datos.nombre,       // <-- ¡CORRECTO!
    datos.email,        // <-- ¡CORRECTO!
    // ... etc
  ];

  // ... código ...
}</code>
</pre>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Slide 12: Resumen del Flujo (antes 13) --><section class="slide" data-title="Demo">
                <div class="w-full max-w-5xl p-10">
                    <h2 class="text-4xl font-bold text-gradient mb-8 text-center">Resumen del Flujo de Datos</h2>
                    <p class="text-center text-lg text-gray-400 mb-6">Lo que acabamos de construir:</p>
                    <img src="https://placehold.co/800x400/111827/D8B4FE?text=Usuario+llena+Form+(Index.html)+%E2%86%92+JS+llama+a+Apps+Script+(Code.gs)+%E2%86%92+Script+escribe+en+Google+Sheet" alt="Flujo de datos" class="rounded-lg shadow-xl w-full h-auto border border-gray-800">
                    <div class="mt-8 grid grid-cols-1 md:grid-cols-3 gap-6 text-center">
                        <div class="p-6 bg-gray-900 rounded-lg shadow border border-gray-800">
                            <h3 class="font-bold text-lg text-purple-400">1. `Index.html` (El Cliente)</h3>
                            <p class="text-gray-400">Presenta el formulario y captura los datos.</p>
                        </div>
                        <div class="p-6 bg-gray-900 rounded-lg shadow border border-gray-800">
                            <h3 class="font-bold text-lg text-pink-400">2. `Code.gs` (El Servidor)</h3>
                            <p class="text-gray-400">Recibe los datos y se comunica con la hoja.</p>
                        </div>
                        <div class="p-6 bg-gray-900 rounded-lg shadow border border-gray-800">
                            <h3 class="font-bold text-lg text-green-400">3. Google Sheet (La Base de Datos)</h3>
                            <p class="text-gray-400">Almacena permanentemente la información.</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Slide 13: El Poder del Prompt (antes 14) --><section class="slide" data-title="Conclusión">
                <div class="w-full max-w-5xl p-10">
                    <h2 class="text-4xl font-bold text-gradient mb-8 text-center">El Verdadero Poder: El Prompt</h2>
                    <div class="flex flex-col md:flex-row items-center bg-gray-900/50 p-8 rounded-2xl border border-gray-800">
                        <div class="md:w-1/2 p-4">
                            <img src="https://placehold.co/600x400/FCD34D/030712?text=Prompt+%3D+Resultado" alt="El Prompt es la clave" class="rounded-lg shadow-md w-full h-auto border border-gray-700">
                        </div>
                        <div class="md:w-1/2 p-4 text-gray-300 space-y-4">
                            <p class="text-lg">El código de Gemini fue bueno porque <strong class="text-amber-300">nuestra solicitud fue buena</strong>.</p>
                            <p class="text-lg"><strong class="text-amber-300">"Basura entra, basura sale"</strong> aplica 100% a la IA.</p>
                            <p class="text-lg font-semibold text-white">Una buena solicitud (prompt) debe tener:</p>
                            <ul class="list-disc list-inside space-y-2 text-lg">
                                <li><strong class="code-title-role">ROL:</strong> "Actúa como..."</li>
                                <li><strong class="code-title-context">CONTEXTO:</strong> "Qué necesito y por qué..."</li>
                                <li><strong class="code-title-req">REQUERIMIENTO:</strong> "Qué debe hacer..."</li>
                                <li><strong class="code-title-output">SALIDA:</strong> "Cómo quiero la respuesta..."</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Slide 14: Conclusiones (antes 15) --><section class="slide" data-title="Conclusión">
                <div class="w-full max-w-4xl p-10">
                    <h2 class="text-4xl font-bold text-gradient mb-10 text-center">Conclusiones</h2>
                    <ul class="space-y-6">
                        <li class="flex items-start text-xl">
                            <svg class="w-7 h-7 text-green-400 mr-4 flex-shrink-0 mt-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                            <span class="text-gray-300">La IA (Gemini) es un <strong class="text-white">multiplicador de productividad</strong>, no un reemplazo. Es tu programador asistente.</span>
                        </li>
                        <li class="flex items-start text-xl">
                            <svg class="w-7 h-7 text-green-400 mr-4 flex-shrink-0 mt-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                            <span class="text-gray-300">Puedes crear herramientas <strong class="text-white">reales y útiles</strong> (como esta encuesta) en minutos, no en días.</span>
                        </li>
                        <li class="flex items-start text-xl">
                            <svg class="w-7 h-7 text-green-400 mr-4 flex-shrink-0 mt-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                            <span class="text-gray-300">La habilidad clave del futuro no es programar, es <strong class="text-white">saber pedir, validar y depurar</strong> lo que la IA te entrega.</span>
                        </li>
                    </ul>
                    <div class="mt-12 p-6 bg-purple-900/30 border border-purple-700 text-purple-200 rounded-lg text-center">
                        <p class="text-xl font-semibold">¡Empieza a automatizar tus propias tareas!</p>
                    </div>
                </div>
            </section>

            <!-- Slide 15: Preguntas (antes 16) --><section class="slide" data-title="Final">
                <div class="w-full max-w-4xl p-10 text-center">
                    <h1 class="text-7xl font-extrabold text-gradient mb-8">¿Preguntas?</h1>
                    <p class="text-2xl text-gray-400 mb-4">¡Muchas gracias por tu participación!</p>
                    <div class="mt-10">
                        <p class="signature">Wilson Pareja Castaño</p>
                        <p class="text-md text-gray-500">Vector Organización y Cultura TED</p>
                    </div>
                </div>
            </section>
            
            <!-- Slide 16: Certificado (antes 17) --><section class="slide" data-title="Final">
                <div class="w-full max-w-4xl p-10 text-center">
                    <h1 class="text-5xl font-extrabold text-gradient mb-8">Certificado de Participación</h1>
                    <p class="text-xl text-gray-400 mb-10">Haz clic en el enlace para generar tu certificado:</p>
                    
                    <a href="https://script.google.com/macros/s/AKfycbxcypFii9WDu05G7i3nNUjZl5TeM6Wmccliy7Easd4ATsOgJzqGhR3tPMuxYPiRGX7AlQ/exec" 
                       target="_blank" 
                       rel="noopener noreferrer"
                       class="inline-block bg-green-600 text-white text-2xl font-bold py-4 px-10 rounded-lg shadow-lg hover:bg-green-700 transform hover:scale-105 transition-all duration-300">
                        Generar mi Certificado
                    </a>
                </div>
            </section>
            
        </div>
    </main>

    <!-- Navegación Inferior Fija (Efecto "Vidrio" sutil) --><footer class="w-full fixed bottom-0 left-0 bg-gray-950/70 backdrop-blur-md p-4 z-50 border-t border-gray-800/70">
        <div class="container mx-auto max-w-7xl flex justify-between items-center">
            <button id="prev-slide" class="bg-purple-600 text-white py-2 px-6 rounded-lg shadow-lg hover:bg-purple-700 disabled:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all">
                Anterior
            </button>
            <div id="slide-counter" class="text-lg font-medium text-gray-300">
                <!-- CONTADOR ACTUALIZADO -->Slide 1 / 17
            </div>
            <button id="next-slide" class="bg-purple-600 text-white py-2 px-6 rounded-lg shadow-lg hover:bg-purple-700 disabled:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all">
                Siguiente
            </button>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const slides = document.querySelectorAll('.slide');
            const totalSlides = slides.length;
            let currentSlide = 0;

            const prevButton = document.getElementById('prev-slide');
            const nextButton = document.getElementById('next-slide');
            const slideCounter = document.getElementById('slide-counter');
            const progressBar = document.getElementById('progress-bar-inner');
            const navLinks = document.querySelectorAll('header nav a');

            // --- Lógica de Pantalla Completa ---
            const fullscreenBtn = document.getElementById('fullscreen-btn');
            const expandIcon = document.getElementById('expand-icon');
            const minimizeIcon = document.getElementById('minimize-icon');

            // Función para abrir la pantalla completa (cross-browser)
            function openFullscreen() {
                const elem = document.documentElement; // El <html> completo
                if (elem.requestFullscreen) {
                    elem.requestFullscreen();
                } else if (elem.mozRequestFullScreen) { // Firefox
                    elem.mozRequestFullScreen();
                } else if (elem.webkitRequestFullscreen) { // Chrome, Safari y Opera
                    elem.webkitRequestFullscreen();
                } else if (elem.msRequestFullscreen) { // IE/Edge
                    elem.msRequestFullscreen();
                }
            }

            // Función para cerrar la pantalla completa (cross-browser)
            function closeFullscreen() {
                if (document.exitFullscreen) {
                    document.exitFullscreen();
                } else if (document.mozCancelFullScreen) { // Firefox
                    document.mozCancelFullScreen();
                } else if (document.webkitExitFullscreen) { // Chrome, Safari y Opera
                    document.webkitExitFullscreen();
                } else if (document.msExitFullscreen) { // IE/Edge
                    document.msExitFullscreen();
                }
            }

            // Comprueba si está en pantalla completa
            function isFullscreen() {
                return document.fullscreenElement ||
                       document.webkitFullscreenElement ||
                       document.mozFullScreenElement ||
                       document.msFullscreenElement;
            }

            // Actualiza el icono basado en el estado
            function updateFullscreenIcon() {
                if (isFullscreen()) {
                    expandIcon.classList.add('hidden');
                    minimizeIcon.classList.remove('hidden');
                    fullscreenBtn.title = "Minimizar Presentación";
                } else {
                    expandIcon.classList.remove('hidden');
                    minimizeIcon.classList.add('hidden');
                    fullscreenBtn.title = "Maximizar Presentación";
                }
            }

            // Event listener para el botón
            fullscreenBtn.addEventListener('click', () => {
                if (isFullscreen()) {
                    closeFullscreen();
                } else {
                    openFullscreen();
                }
            });

            // Listeners para cambios de estado (ej. presionar 'Esc')
            document.addEventListener('fullscreenchange', updateFullscreenIcon);
            document.addEventListener('webkitfullscreenchange', updateFullscreenIcon);
            document.addEventListener('mozfullscreenchange', updateFullscreenIcon);
            document.addEventListener('MSFullscreenChange', updateFullscreenIcon);
            // --- Fin de Lógica de Pantalla Completa ---


            function showSlide(index) {
                if (index < 0 || index >= totalSlides) return; // Fuera de rango

                // Ocultar slide actual
                if (slides[currentSlide]) {
                    slides[currentSlide].classList.remove('slide-active');
                }

                // Mostrar nuevo slide
                currentSlide = index;
                if (slides[currentSlide]) {
                    slides[currentSlide].classList.add('slide-active');
                }

                // Actualizar contador
                if (slideCounter) {
                    slideCounter.textContent = `Slide ${currentSlide + 1} / ${totalSlides}`;
                }

                // Actualizar barra de progreso
                if (progressBar) {
                    const progressPercentage = ((currentSlide) / (totalSlides - 1)) * 100;
                    progressBar.style.width = `${progressPercentage}%`;
                }

                // Deshabilitar botones en los extremos
                if (prevButton) {
                    prevButton.disabled = (currentSlide === 0);
                }
                if (nextButton) {
                    nextButton.disabled = (currentSlide === totalSlides - 1);
                }

                // Actualizar links de navegación (opcional, pero bueno)
                navLinks.forEach(link => {
                    link.classList.remove('text-purple-400', 'font-bold');
                    const linkSlideIndex = parseInt(link.dataset.slide);
                    
                    if (linkSlideIndex === currentSlide) {
                        link.classList.add('text-purple-400', 'font-bold');
                    } else if (slides[currentSlide] && slides[currentSlide].dataset.title === link.dataset.title) {
                        // Resalta el link de la sección (ej. "Componentes")
                        link.classList.add('text-purple-400', 'font-bold');
                    }
                });
            }

            // --- Event Listeners ---

            // Botones de navegación
            if (prevButton) {
                prevButton.addEventListener('click', () => {
                    showSlide(currentSlide - 1);
                });
            }

            if (nextButton) {
                nextButton.addEventListener('click', () => {
                    showSlide(currentSlide + 1);
                });
            }

            // Navegación con teclado (flechas)
            document.addEventListener('keydown', (e) => {
                if (e.key === 'ArrowRight' || e.key === ' ') {
                    e.preventDefault(); // Prevenir scroll con barra espaciadora
                    showSlide(currentSlide + 1);
                } else if (e.key === 'ArrowLeft') {
                    e.preventDefault();
                    showSlide(currentSlide - 1);
                } else if (e.key === 'f' || e.key === 'F') {
                     e.preventDefault(); // Prevenir búsqueda
                     if (isFullscreen()) {
                        closeFullscreen();
                    } else {
                        openFullscreen();
                    }
                }
            });

            // Links del encabezado
            navLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const slideIndex = parseInt(link.dataset.slide);
                    if (!isNaN(slideIndex)) {
                        showSlide(slideIndex);
                    }
                });
            });

            // Mostrar el primer slide (0) al cargar
            showSlide(0);
        });
    </script>

</body>
</html>

